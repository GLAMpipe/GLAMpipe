<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GLAMpipe</title>
<script type="text/javascript" src="/js/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="/js/knockout.js"></script>
<script type="text/javascript" src="/js/project.js"></script>
<script src="http://cdn.socket.io/socket.io-1.2.0.js"></script>
<script type="text/javascript" src="/js/require.js"></script>


<link rel="stylesheet" type="text/css" href="/css/metapipe.css" />
<link rel="stylesheet" type="text/css" href="/css/jquery-ui.css" />


<script type="text/html" id="node-template">
	<div data-bind="attr:{id:_id, 'data-collection':collection},style:{left:x+'px', top:y+'px'},css:type" class="block node draggable"> 
		<div class="delete_icon" data-bind="click:$root.deleteNodeConfirm">X</div>
		
		<h2 data-bind="click:$root.selectNode, html:type.toUpperCase() +': '+ title "></h2> 



		<div class="delete_confirm" style="display:none">
			<button class="delete warning" data-bind="click:$root.reallyDeleteNode">Really delete?</button>
			<button class="good" data-bind="click:$root.cancelDeleteNode">No delete, no!</button>
		</div>
		
	   <div  class="node_info">
		   <!-- ko if: type == 'collection' --> 
		   <p class="node_title" data-bind="html:collection"></p> 
		   <!-- /ko -->
		   <!-- ko if: type != 'collection' --> 
			<p class="node_title" data-bind="html:params.title"></p> 
			<!-- /ko -->
		</div>

		
		<div>
			
			<!-- ko if: type == 'collection' --> 
				<button data-bind="click: $root.openSourceCreator" class="add_node after_left">add source</button> 
                <button data-bind="click: $root.openCreator" class="add_node right">add node</button> 
			<div class="left bottom">
				<a class="left view_button" data-bind="click:$root.openTab">view data</a> 	
			</div>
			<!-- /ko -->
			
			<!-- ko if: type == 'view' --> 
			<div class="bottom">
				<a class="left view_button" data-bind="attr:{href:'/node/fileview/' + _id + '?view=georeferencer.html'}" target="_blank" >georeferencer</a> 	
			</div>
			<!-- /ko -->
		</div>

	</div>

</script>


</head>

<body>
    <button data-bind="click: openCollectionCreator" class="right" >add collection</button>
    
    
    <!-- PROJECT NODES -->
	<div class="collection_pipe">
		<h2><a href="/"><</a> Project: jotain</h2>
		<div class="pipe" data-bind="template: { name: 'node-template', foreach: projectNodes }"></div>
	</div>

    <!-- VIEW TABS -->
	<div class="collection_view">
		<h2>Data in collection: jotain</h2>
        <div id="tabs">
            <ul>
                <li><a class="tabref" href="#tabs-1" rel="http://artturimatias.github.io/GLAMpipe/">Welcome!</a><span class="ui-icon ui-icon-close" role="presentation">Remove Tab</span></li>

            </ul>
          <div class="tab" id="tabs-1">
          </div>
        </div>
	</div>


    <!-- NODE CREATOR -->
	<div id="node_creator">
		<button data-bind="click:closeCreator">close</button>
		<h1>Choose node type</h1>
		<!-- ko foreach: collection -->
		<div data-bind="attr:{id:_id.type + '_node', class:_id.type}">
			<h2 data-bind="text: _id.type,click:$parent.openNodeTypes"></h2>
			<p data-bind="html:_id.description"></p>
			<div data-bind="foreach: subtypes" class="node_types" style="display:none">
				<div data-bind="attr:{id:sub.subtype + '_node', class:sub.subtype}">
					<h3 data-bind="text: sub.subtype"></h3>
					<div class="node_types" >
						<ul data-bind="foreach: nodes" class="node_types">
							<li>
								<div data-bind="html:title, click:$root.openNodeParams"></div>
								
								<div data-bind="html:params" ></div>
							</li>
							
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- /ko -->
	</div>
	
    <div id="footer">
        <div id="console"></div>
    </div>

</body>
</html>
