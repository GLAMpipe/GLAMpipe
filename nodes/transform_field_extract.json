{
	"nodeid": "transform_field_extract",
	"title": "Extract",
	"type": "transform",
	"subtype": "string manipulation",
	"description": "Extract some piece from string",
	"scripts": {
		"hello": "out.say('news', 'You added a Extract node'); ",
        "bye": "out.say('news', 'Deleted Split node. Bye!'); ",
        "init":
        [
			"out.say('progress', 'Starting Extracting...');",
			"/* set output field */",
			"out.field = context.node.params.in_field + context.node.params.suffix; "
		],
		"run": 
		[
			"var reg = new RegExp('[^ ]*'); ",
            "var val = context.doc[context.node.params.in_field]; ",
			"var splitted = val.split(context.node.settings.end); ",
			"if (context.node.settings.start_end == 'start') { ",
			"    out.value = splitted[0]; ",
			"} else { ",
			"    out.value = splitted[splitted.length -1]; ",
			"}"
		],
		"finish": "out.say('finish', 'Split done!');"
	},
	
	"views": {
		"params":
		[
			"<label>Note title</label> <input name='title'/>",
			"<label>in field:</label> <input class='dynamic_field' name='in_field'/>",
			"<label>output field suffix:</label> <input name='suffix'/ value='_extracted'>"
		],
        "settings":
        [
			"",
            "<label>direction</label>",
            "<select name='start_end'>",
            "    <option value='start'>from start of the line</option>",
            "    <option value='end'>from end of the line</option>",
            "</select>",
            "<label>read until this or these characters appear</label>",
            "<input name='end'/>"
        ]
	}
}
