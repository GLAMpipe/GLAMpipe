{
	"nodeid": "transform_wikimedia_commons_pagename",
	"title": "Create commons pagename",
	"type": "transform",
	"subtype": "wikimedia",
	"description": "Create commons page title",
	"scripts": {
		"hello": "out.say('news', 'You added a page name node'); ",
        "bye": "out.say('news', 'Deleted page name node. Bye!'); ",
        "init":
        [
			"out.say('progress', 'Starting...');",
			"/* set output field */",
			"out.field = context.node.params.out_field; ",
			
			""
		],
		
		"run": 
		[

            "var settings = context.node.settings; ",
			"var arr = []; ",
			"arr.push(settings.prefix); ",
            "arr.push(context.doc[settings.field1]); ",
			"arr.push(settings.after_field1); ",
            "arr.push(context.doc[settings.field2]); ",
			"arr.push(settings.after_field2); ",
            "arr.push(context.doc[settings.field3]); ",
			"arr.push(settings.suffix); ",
			"out.value = arr.join(''); "
		],
		
		"finish": "out.say('finish', 'Commons names created done!');",
		
		"view":
		[    
			"/* create view based on settings user defined */",
			"var node = context.node.settings; ",
			"var html = '<h2>Here are your page names for wikimedia commons!</h2>'; ",
			"html += '<div><table><thead>'; ",
			"html += '<tr>'; ",
			"html += '  <th id=\"' + context.node.params.out_field +'\" >'+context.node.params.out_field+'</th>'; ",
			"html += '  <th id=\"' + node.field1 +'\" >'+node.field1+'</th>'; ",
			"html += '  <th id=\"' + node.field2 +'\" >'+node.field2+'</th>'; ",
			"html += '  <th id=\"' + node.field3 +'\" >'+node.field3+'</th>'; ",
			"html += '</tr></thead>'; ",
			"html += '<tbody data-bind=\"foreach: collection\">'; ",
			"html += '  <tr>'; ",
			"html += '    <td data-bind=\"text: ' + context.node.params.out_field + '\"></td>'; ",
			"html += '    <td data-bind=\"text: ' + node.field1 + '\"></td>'; ",
			"html += '    <td data-bind=\"text: ' + node.field2 + '\"></td>'; ",
			"html += '    <td data-bind=\"text: ' + node.field3 + '\"></td>'; ",
			"html += '    '; ",
			"html += '  </tr>'; ",
			"html += '</tbody>'; ",
			"html += '</table></div>'; ",
			"out.view = html; "
		]
	},
	
	"views": {
		"params": "<label>where to save page title?</label> <input name='out_field'/ value='commons_title'/>",
		"settings":
		[
			"<label>select fields:</label>",
			"<input class='short_input' name='prefix'/> + <input class='dynamic_field middle_input' name='field1'/> + <br>",
			"<input class='short_input' name='after_field1'/> + <input class='dynamic_field middle_input' name='field2'/> + <br>",
			"<input class='short_input' name='after_field2'/> + <input class='dynamic_field middle_input' name='field3'/> + <br>",
			"<input class='short_input' name='suffix'/>"
		]
	}
}
